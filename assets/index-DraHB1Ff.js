import{r as n,j as e,c as P}from"./react-vendor-BzzwJzSH.js";import{s as g}from"./suncalc-DPRD1gft.js";import"./vendor-SPyfQU6S.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))u(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function d(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(r){if(r.ep)return;r.ep=!0;const o=d(r);fetch(r.href,o)}})();const A=(a,l)=>{const d=new Date,u=g.getTimes(d,a,l).sunset;return(g.getPosition(u,a,l).azimuth*180/Math.PI+180)%360},D=a=>(360-a)%360,L=()=>{const[a,l]=n.useState(null),[d,u]=n.useState(0),[r,o]=n.useState(0),[m,h]=n.useState(null),[v,f]=n.useState(!1),[p,j]=n.useState(null),[N,y]=n.useState("environment"),c=n.useRef(null),E=n.useRef(null);n.useEffect(()=>{const s=i=>{l({lat:i.coords.latitude,lng:i.coords.longitude})},t=i=>{h(i.message||"Erro ao obter localização")};if(!navigator.geolocation){h("Geolocalização não suportada");return}navigator.geolocation.getCurrentPosition(s,t,{enableHighAccuracy:!0,timeout:5e3})},[]),n.useEffect(()=>{if(a){const s=A(a.lat,a.lng);u(s)}},[a]),n.useEffect(()=>{const s=t=>{if(t.alpha!==null){let i=t.alpha;typeof t.webkitCompassHeading<"u"&&(i=t.webkitCompassHeading),o(D(i))}};return window.addEventListener("deviceorientation",s,!0),()=>{window.removeEventListener("deviceorientation",s)}},[]);const x=async()=>{try{const s={video:{facingMode:N,width:{ideal:1280},height:{ideal:720}}},t=await navigator.mediaDevices.getUserMedia(s);c.current&&(c.current.srcObject=t,c.current.onloadedmetadata=()=>{c.current.play().catch(()=>{h("Toque para iniciar a câmera")})},f(!0))}catch(s){h(s.message),f(!1)}},O=async()=>{var s;y(t=>t==="user"?"environment":"user"),(s=c.current)!=null&&s.srcObject&&c.current.srcObject.getTracks().forEach(t=>t.stop()),await x()},S=()=>{const s=c.current,t=E.current;if(s&&t){t.width=s.videoWidth,t.height=s.videoHeight;const i=t.getContext("2d");i.translate(t.width,0),i.scale(-1,1),i.drawImage(s,0,0,t.width,t.height),j(t.toDataURL("image/jpeg",.9))}},C=()=>{var s;(s=c.current)!=null&&s.srcObject&&c.current.srcObject.getTracks().forEach(t=>t.stop()),f(!1),j(null)},b=()=>(d-r+360)%360,w=Math.abs(b())<5;return e.jsxs("div",{className:"app-container",children:[e.jsx("h1",{children:"🌅 Guia Fotográfico do Pôr do Sol"}),v&&e.jsxs("div",{className:"camera-container",children:[e.jsx("video",{ref:c,className:"camera-preview",playsInline:!0,muted:!0}),e.jsxs("div",{className:"camera-controls",children:[e.jsx("button",{className:"camera-btn flip-btn",onClick:O,children:"🔄"}),e.jsx("button",{className:"camera-btn capture-btn",onClick:S,children:"⭕"}),e.jsx("button",{className:"camera-btn close-btn",onClick:C,children:"✖"})]}),p&&e.jsxs("div",{className:"photo-preview",children:[e.jsx("img",{src:p,alt:"Foto capturada"}),e.jsx("a",{href:p,download:`por-do-sol-${Date.now()}.jpg`,className:"download-button",children:"⬇️ Baixar"})]})]}),!v&&e.jsx("button",{className:"main-camera-btn",onClick:x,children:"📸 Ativar Câmera"}),e.jsxs("div",{className:"compass-wrapper",children:[e.jsxs("div",{className:"compass",children:[e.jsx("div",{className:"direction-arrow",style:{transform:`rotate(${b()}deg)`},children:e.jsx("div",{className:"sun-indicator",children:"☀️"})}),e.jsx("div",{className:"alignment-marker"})]}),e.jsxs("div",{className:"info-panel",children:[e.jsxs("p",{children:["⏱ Horário do pôr do sol: ",a&&new Date(g.getTimes(new Date,a.lat,a.lng).sunset).toLocaleTimeString()]}),e.jsxs("p",{children:["🧭 Direção: ",d.toFixed(1),"°"]}),e.jsx("div",{className:`alignment-feedback ${w?"aligned":""}`,children:w?"⭐ ALINHADO! ⭐":"Gire o dispositivo... ➡️"})]})]}),m&&e.jsx("div",{className:"error-banner",children:m})]})};P.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(L,{})}));
//# sourceMappingURL=index-DraHB1Ff.js.map
