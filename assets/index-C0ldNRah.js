import{r as a,j as t,c as k}from"./react-vendor-BzzwJzSH.js";import{s as p}from"./suncalc-DPRD1gft.js";import"./vendor-SPyfQU6S.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))m(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&m(f)}).observe(document,{childList:!0,subtree:!0});function d(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function m(o){if(o.ep)return;o.ep=!0;const c=d(o);fetch(o.href,c)}})();const R=(r,l)=>{const d=new Date,m=p.getTimes(d,r,l).sunset;return(p.getPosition(m,r,l).azimuth*180/Math.PI+180)%360},H=r=>(360-r)%360,M=()=>{const[r,l]=a.useState(null),[d,m]=a.useState(0),[o,c]=a.useState(0),[f,g]=a.useState(null),[v,x]=a.useState(!1),[b,N]=a.useState(null),[j,P]=a.useState("environment"),[C,w]=a.useState(!1),[h,D]=a.useState({sunrise:null,sunset:null,solarNoon:null}),i=a.useRef(null),y=a.useRef(null);a.useEffect(()=>{const e=n=>{l({lat:n.coords.latitude,lng:n.coords.longitude})},s=n=>{g(n.message||"Erro ao obter localiza√ß√£o")};if(!navigator.geolocation){g("Geolocaliza√ß√£o n√£o suportada");return}navigator.geolocation.getCurrentPosition(e,s,{enableHighAccuracy:!0,timeout:5e3})},[]),a.useEffect(()=>{if(r){const e=R(r.lat,r.lng);m(e)}},[r]),a.useEffect(()=>{const e=s=>{if(s.alpha!==null){let n=s.alpha;typeof s.webkitCompassHeading<"u"&&(n=s.webkitCompassHeading),c(H(n))}};return window.DeviceOrientationEvent?window.addEventListener("deviceorientation",e,!0):g("Sensor de orienta√ß√£o n√£o suportado neste dispositivo"),()=>{window.removeEventListener("deviceorientation",e)}},[]),a.useEffect(()=>{if(r){const e=()=>{const n=p.getPosition(new Date,r.lat,r.lng);w(n.altitude>0)};e();const s=setInterval(e,6e4);return()=>clearInterval(s)}},[r]),a.useEffect(()=>{if(r){const e=()=>{const n=new Date,u=p.getTimes(n,r.lat,r.lng),z=p.getPosition(n,r.lat,r.lng);D({sunrise:u.sunrise,sunset:u.sunset,solarNoon:u.solarNoon}),w(z.altitude>0)};e();const s=setInterval(e,6e4);return()=>clearInterval(s)}},[r]),a.useEffect(()=>{let e=null;return v&&(async()=>{try{if(i.current&&i.current.srcObject)return;const n={video:{facingMode:j,width:{ideal:1280},height:{ideal:720}}};i.current&&i.current.srcObject&&(i.current.srcObject.getTracks().forEach(u=>u.stop()),i.current.srcObject=null),e=await navigator.mediaDevices.getUserMedia(n),i.current&&(i.current.srcObject=e,i.current.onloadedmetadata=()=>{i.current.play().catch(u=>{g("Erro ao reproduzir v√≠deo: "+u.message)})})}catch(n){g("Erro ao acessar c√¢mera: "+n.message),x(!1)}})(),()=>{e&&e.getTracks().forEach(n=>n.stop())}},[v,j]);const A=()=>{P(e=>e==="user"?"environment":"user")},I=()=>{const e=i.current,s=y.current;if(e&&s&&e.readyState>=2){s.width=e.videoWidth,s.height=e.videoHeight;const n=s.getContext("2d");j==="user"&&(n.translate(s.width,0),n.scale(-1,1)),n.drawImage(e,0,0,s.width,s.height),N(s.toDataURL("image/jpeg",.9))}},L=()=>{var e;(e=i.current)!=null&&e.srcObject&&(i.current.srcObject.getTracks().forEach(s=>s.stop()),i.current.srcObject=null),x(!1),N(null)};a.useEffect(()=>()=>{var e;(e=i.current)!=null&&e.srcObject&&i.current.srcObject.getTracks().forEach(s=>s.stop())},[]);const E=()=>{let e=(d-o+360)%360;return e>180&&(e-=360),e},O=Math.abs(E())<15;return t.jsxs("div",{className:`app-container ${C?"day-theme":"night-theme"}`,children:[t.jsx("h1",{children:"üåÖ Localizando o P√¥r do Sol"}),t.jsxs("div",{className:"sun-info",children:[t.jsxs("div",{className:"info-card",children:[t.jsx("span",{children:"‚òÄÔ∏è Nascer do sol"}),t.jsx("strong",{children:S(h==null?void 0:h.sunrise)})]}),t.jsxs("div",{className:"info-card",children:[t.jsx("span",{children:"üåá P√¥r do sol"}),t.jsx("strong",{children:S(h==null?void 0:h.sunset)})]})]}),v&&t.jsxs("div",{className:"camera-container",children:[t.jsx("video",{ref:i,className:`camera-preview${j==="user"?" mirrored":""}`,playsInline:!0,muted:!0}),t.jsxs("div",{className:"camera-controls",children:[t.jsx("button",{className:"camera-btn",onClick:A,"aria-label":"Alternar c√¢mera",children:"üîÑ"}),t.jsx("button",{className:"camera-btn capture-btn",onClick:I,"aria-label":"Capturar foto",children:"‚≠ï"}),t.jsx("button",{className:"camera-btn",onClick:L,"aria-label":"Fechar c√¢mera",children:"‚úñ"})]}),b&&t.jsxs("div",{className:"photo-preview",children:[t.jsx("img",{src:b,alt:"Foto capturada"}),t.jsx("a",{href:b,download:`por-do-sol-${Date.now()}.jpg`,className:"download-button",children:"‚¨áÔ∏è Baixar"}),t.jsx("button",{onClick:()=>N(null),className:"close-button",children:"‚ùå Fechar"})]})]}),t.jsxs("div",{className:"compass-wrapper",children:[t.jsxs("div",{className:"compass",children:[t.jsx("div",{className:"direction-arrow",style:{transform:`rotate(${E()}deg)`},children:t.jsx("div",{className:"sun-indicator",children:"‚òÄÔ∏è"})}),t.jsx("div",{className:"alignment-marker"})]}),!v&&t.jsx("button",{className:"main-camera-btn",onClick:()=>x(!0),children:"üì∏ Ativar C√¢mera"}),t.jsxs("div",{className:"info-panel",children:[t.jsxs("p",{children:["üß≠ Dire√ß√£o: ",d.toFixed(1),"¬∞"]}),t.jsx("div",{className:`alignment-feedback ${O?"aligned":""}`,children:O?"‚≠ê ALINHADO! ‚≠ê":"Gire o dispositivo... ‚û°Ô∏è"})]})]}),f&&t.jsx("div",{className:"error-banner",children:f}),t.jsx("canvas",{ref:y,style:{display:"none"}})]})};function S(r){return r?new Date(r).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"--:--"}k.createRoot(document.getElementById("root")).render(t.jsx(a.StrictMode,{children:t.jsx(M,{})}));
//# sourceMappingURL=index-C0ldNRah.js.map
