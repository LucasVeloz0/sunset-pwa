{"version":3,"file":"index-BBIcpj3v.js","sources":["../../src/utils/sunUtils.js","../../src/App.jsx","../../src/main.jsx"],"sourcesContent":["import * as SunCalc from 'suncalc'; // Adicione esta linha no topo\n\n/**\n * Calcula a dire√ß√£o do p√¥r do sol em graus\n * @param {number} lat - Latitude\n * @param {number} lng - Longitude\n * @returns {number} Azimute em graus (0 = Norte, 90 = Leste)\n */\nexport const getSunsetDirection = (lat, lng) => {\n  const now = new Date();\n  const sunsetTime = SunCalc.getTimes(now, lat, lng).sunset;\n  const sunPos = SunCalc.getPosition(sunsetTime, lat, lng);\n  return ((sunPos.azimuth * 180 / Math.PI) + 180) % 360;\n};\n\n/**\n * Normaliza a orienta√ß√£o do dispositivo\n * @param {number} alpha - √Çngulo da b√∫ssola (0-360)\n * @returns {number} √Çngulo ajustado\n */\nexport const normalizeOrientation = (alpha) => {\n  return (360 - alpha) % 360;\n};","import React, { useState, useEffect, useRef } from 'react';\nimport * as SunCalc from 'suncalc';\nimport { getSunsetDirection, normalizeOrientation } from './utils/sunUtils';\nimport './App.css';\n\nconst App = () => {\n  const [position, setPosition] = useState(null);\n  const [sunAzimuth, setSunAzimuth] = useState(0);\n  const [deviceHeading, setDeviceHeading] = useState(0);\n  const [error, setError] = useState(null);\n  const [arMode, setArMode] = useState(false);\n  const videoRef = useRef(null);\n\n  // 1. Obter geolocaliza√ß√£o\n  useEffect(() => {\n    const handleSuccess = (pos) => {\n      setPosition({\n        lat: pos.coords.latitude,\n        lng: pos.coords.longitude\n      });\n    };\n\n    const handleError = (err) => {\n      setError(err.message || 'Erro ao obter localiza√ß√£o');\n    };\n\n    if (!navigator.geolocation) {\n      setError('Geolocaliza√ß√£o n√£o suportada');\n      return;\n    }\n\n    navigator.geolocation.getCurrentPosition(handleSuccess, handleError, {\n      enableHighAccuracy: true,\n      timeout: 5000\n    });\n  }, []);\n\n  // 2. Calcular dire√ß√£o do sol\n  useEffect(() => {\n    if (position) {\n      const azimuth = getSunsetDirection(position.lat, position.lng);\n      setSunAzimuth(azimuth);\n    }\n  }, [position]);\n\n  // 3. Configurar sensor de orienta√ß√£o\n  useEffect(() => {\n    const handleOrientation = (event) => {\n      if (event.alpha !== null) {\n        let alpha = event.alpha;\n        // Corre√ß√£o para iOS\n        if (typeof event.webkitCompassHeading !== 'undefined') {\n          alpha = event.webkitCompassHeading;\n        }\n        setDeviceHeading(normalizeOrientation(alpha));\n      }\n    };\n\n    window.addEventListener('deviceorientation', handleOrientation, true);\n    \n    return () => {\n      window.removeEventListener('deviceorientation', handleOrientation);\n    };\n  }, []);\n\n  // 4. Listener para Android (adicione aqui)\nuseEffect(() => {\n  if (arMode && videoRef.current) {\n    const videoElement = videoRef.current;\n    \n    const handleCanPlay = () => {\n      videoElement.play().catch(e => console.log('Auto-play error:', e));\n    };\n    \n    videoElement.oncanplay = handleCanPlay;\n    \n    return () => {\n      videoElement.oncanplay = null;\n    };\n  }\n}, [arMode]);\n\n// 5. Listener para iOS (adicione aqui)\nuseEffect(() => {\n  if (arMode) {\n    const handleTouchStart = () => {\n      if (videoRef.current) {\n        videoRef.current.play().catch(e => console.log('Touch play error:', e));\n      }\n    };\n    \n    document.addEventListener('touchstart', handleTouchStart);\n    \n    return () => {\n      document.removeEventListener('touchstart', handleTouchStart);\n    };\n  }\n}, [arMode]);\n\n  // 4. Ativar modo AR\n  const activateAR = async () => {\n    try {\n      // 1. Configura√ß√µes otimizadas para mobile\n      const constraints = {\n        video: {\n          facingMode: 'environment',\n          width: { ideal: 1920 },\n          height: { ideal: 1080 }\n        }\n      };\n  \n      // 2. Solicitar stream de v√≠deo\n      const stream = await navigator.mediaDevices.getUserMedia(constraints);\n      \n      // 3. Configurar elemento de v√≠deo\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        \n        // Configura√ß√µes cruciais para iOS\n        videoRef.current.playsInline = true;\n        videoRef.current.muted = true;\n        videoRef.current.setAttribute('playsinline', 'true');\n        videoRef.current.setAttribute('muted', 'true');\n        \n        // 4. Iniciar v√≠deo com fallback\n        const playPromise = videoRef.current.play();\n        \n        if (playPromise !== undefined) {\n          playPromise.catch(err => {\n            console.error('Erro ao reproduzir:', err);\n            // Fallback para iOS\n            setTimeout(() => {\n              videoRef.current?.play();\n            }, 300);\n          });\n        }\n        \n        setArMode(true);\n      }\n    } catch (err) {\n      console.error('Erro AR:', err);\n      setError(`Erro: ${err.message}`);\n      setArMode(false);\n    }\n  };\n\n  // 5. Calcular √¢ngulo relativo\n  const calculateRelativeAngle = () => {\n    return (sunAzimuth - deviceHeading + 360) % 360;\n  };\n\n  // 6. Verificar alinhamento\n  const isAligned = Math.abs(calculateRelativeAngle()) < 5;\n\n  return (\n    <div className=\"app-container\">\n      {arMode && (\n        <video \n          ref={videoRef}\n          className=\"ar-video\"\n          autoPlay\n          playsInline\n        />\n      )}\n\n      <h1>üåÖ Ca√ßador de P√¥r do Sol</h1>\n      \n      <button \n        className=\"ar-button\"\n        onClick={() => {\n          if (arMode) {\n            setArMode(false);\n            if (videoRef.current && videoRef.current.srcObject) {\n              // Para a c√¢mera ao sair do modo AR\n              const tracks = videoRef.current.srcObject.getTracks();\n              tracks.forEach(track => track.stop());\n              videoRef.current.srcObject = null;\n            }\n          } else {\n            activateAR();\n          }\n        }}\n      >\n        {arMode ? 'üì∑ Sair do AR' : 'üåç Modo AR'}\n      </button>\n\n      {error && <div className=\"error-banner\">{error}</div>}\n\n      <div className={`compass-wrapper ${arMode ? 'ar-active' : ''}`}>\n        <div className=\"compass\">\n          <div \n            className=\"direction-arrow\"\n            style={{ transform: `rotate(${calculateRelativeAngle()}deg)` }}\n          >\n            <div className=\"sun-indicator\">‚òÄÔ∏è</div>\n          </div>\n          <div className=\"alignment-marker\"></div>\n        </div>\n\n        <div className=\"info-panel\">\n          <p>‚è± Hor√°rio do p√¥r do sol: {\n            position && \n            new Date(SunCalc.getTimes(new Date(), position.lat, position.lng).sunset)\n              .toLocaleTimeString()\n          }</p>\n          <p>üß≠ Dire√ß√£o: {sunAzimuth.toFixed(1)}¬∞</p>\n          <div className={`alignment-feedback ${isAligned ? 'aligned' : ''}`}>\n            {isAligned ? '‚≠ê ALINHADO! ‚≠ê' : 'Gire o dispositivo... ‚û°Ô∏è'}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;","import { StrictMode } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport './index.css'\nimport App from './App.jsx'\n\ncreateRoot(document.getElementById('root')).render(\n  <StrictMode>\n    <App />\n  </StrictMode>,\n)\n"],"names":["getSunsetDirection","lat","lng","now","sunsetTime","SunCalc.getTimes","SunCalc.getPosition","normalizeOrientation","alpha","App","position","setPosition","useState","sunAzimuth","setSunAzimuth","deviceHeading","setDeviceHeading","error","setError","arMode","setArMode","videoRef","useRef","useEffect","handleSuccess","pos","handleError","err","azimuth","handleOrientation","event","videoElement","handleCanPlay","e","handleTouchStart","activateAR","constraints","stream","playPromise","_a","calculateRelativeAngle","isAligned","jsxs","jsx","track","createRoot","StrictMode"],"mappings":"00BAQO,MAAMA,EAAqB,CAACC,EAAKC,IAAQ,CAC9C,MAAMC,EAAM,IAAI,KACVC,EAAaC,EAAAA,SAAiBF,EAAKF,EAAKC,CAAG,EAAE,OAEnD,OADeI,EAAmB,YAACF,EAAYH,EAAKC,CAAG,EACvC,QAAU,IAAM,KAAK,GAAM,KAAO,GACpD,EAOaK,EAAwBC,IAC3B,IAAMA,GAAS,IChBnBC,EAAM,IAAM,CAChB,KAAM,CAACC,EAAUC,CAAW,EAAIC,EAAAA,SAAS,IAAI,EACvC,CAACC,EAAYC,CAAa,EAAIF,EAAAA,SAAS,CAAC,EACxC,CAACG,EAAeC,CAAgB,EAAIJ,EAAAA,SAAS,CAAC,EAC9C,CAACK,EAAOC,CAAQ,EAAIN,EAAAA,SAAS,IAAI,EACjC,CAACO,EAAQC,CAAS,EAAIR,EAAAA,SAAS,EAAK,EACpCS,EAAWC,SAAO,IAAI,EAG5BC,EAAAA,UAAU,IAAM,CACR,MAAAC,EAAiBC,GAAQ,CACjBd,EAAA,CACV,IAAKc,EAAI,OAAO,SAChB,IAAKA,EAAI,OAAO,SAAA,CACjB,CACH,EAEMC,EAAeC,GAAQ,CAClBT,EAAAS,EAAI,SAAW,2BAA2B,CACrD,EAEI,GAAA,CAAC,UAAU,YAAa,CAC1BT,EAAS,8BAA8B,EACvC,MAAA,CAGQ,UAAA,YAAY,mBAAmBM,EAAeE,EAAa,CACnE,mBAAoB,GACpB,QAAS,GAAA,CACV,CACH,EAAG,EAAE,EAGLH,EAAAA,UAAU,IAAM,CACd,GAAIb,EAAU,CACZ,MAAMkB,EAAU5B,EAAmBU,EAAS,IAAKA,EAAS,GAAG,EAC7DI,EAAcc,CAAO,CAAA,CACvB,EACC,CAAClB,CAAQ,CAAC,EAGba,EAAAA,UAAU,IAAM,CACR,MAAAM,EAAqBC,GAAU,CAC/B,GAAAA,EAAM,QAAU,KAAM,CACxB,IAAItB,EAAQsB,EAAM,MAEd,OAAOA,EAAM,qBAAyB,MACxCtB,EAAQsB,EAAM,sBAECd,EAAAT,EAAqBC,CAAK,CAAC,CAAA,CAEhD,EAEO,cAAA,iBAAiB,oBAAqBqB,EAAmB,EAAI,EAE7D,IAAM,CACJ,OAAA,oBAAoB,oBAAqBA,CAAiB,CACnE,CACF,EAAG,EAAE,EAGPN,EAAAA,UAAU,IAAM,CACV,GAAAJ,GAAUE,EAAS,QAAS,CAC9B,MAAMU,EAAeV,EAAS,QAExBW,EAAgB,IAAM,CACbD,EAAA,OAAO,MAAME,GAAK,QAAQ,IAAI,mBAAoBA,CAAC,CAAC,CACnE,EAEA,OAAAF,EAAa,UAAYC,EAElB,IAAM,CACXD,EAAa,UAAY,IAC3B,CAAA,CACF,EACC,CAACZ,CAAM,CAAC,EAGXI,EAAAA,UAAU,IAAM,CACd,GAAIJ,EAAQ,CACV,MAAMe,EAAmB,IAAM,CACzBb,EAAS,SACFA,EAAA,QAAQ,KAAO,EAAA,SAAW,QAAQ,IAAI,oBAAqBY,CAAC,CAAC,CAE1E,EAES,gBAAA,iBAAiB,aAAcC,CAAgB,EAEjD,IAAM,CACF,SAAA,oBAAoB,aAAcA,CAAgB,CAC7D,CAAA,CACF,EACC,CAACf,CAAM,CAAC,EAGT,MAAMgB,EAAa,SAAY,CACzB,GAAA,CAEF,MAAMC,EAAc,CAClB,MAAO,CACL,WAAY,cACZ,MAAO,CAAE,MAAO,IAAK,EACrB,OAAQ,CAAE,MAAO,IAAK,CAAA,CAE1B,EAGMC,EAAS,MAAM,UAAU,aAAa,aAAaD,CAAW,EAGpE,GAAIf,EAAS,QAAS,CACpBA,EAAS,QAAQ,UAAYgB,EAG7BhB,EAAS,QAAQ,YAAc,GAC/BA,EAAS,QAAQ,MAAQ,GAChBA,EAAA,QAAQ,aAAa,cAAe,MAAM,EAC1CA,EAAA,QAAQ,aAAa,QAAS,MAAM,EAGvC,MAAAiB,EAAcjB,EAAS,QAAQ,KAAK,EAEtCiB,IAAgB,QAClBA,EAAY,MAAaX,GAAA,CACf,QAAA,MAAM,sBAAuBA,CAAG,EAExC,WAAW,IAAM,QACfY,EAAAlB,EAAS,UAAT,MAAAkB,EAAkB,QACjB,GAAG,CAAA,CACP,EAGHnB,EAAU,EAAI,CAAA,QAETO,EAAK,CACJ,QAAA,MAAM,WAAYA,CAAG,EACpBT,EAAA,SAASS,EAAI,OAAO,EAAE,EAC/BP,EAAU,EAAK,CAAA,CAEnB,EAGMoB,EAAyB,KACrB3B,EAAaE,EAAgB,KAAO,IAIxC0B,EAAY,KAAK,IAAID,EAAA,CAAwB,EAAI,EAGrD,OAAAE,EAAA,KAAC,MAAI,CAAA,UAAU,gBACZ,SAAA,CACCvB,GAAAwB,EAAA,IAAC,QAAA,CACC,IAAKtB,EACL,UAAU,WACV,SAAQ,GACR,YAAW,EAAA,CACb,EAGFsB,EAAAA,IAAC,MAAG,SAAwB,0BAAA,CAAA,EAE5BA,EAAA,IAAC,SAAA,CACC,UAAU,YACV,QAAS,IAAM,CACTxB,GACFC,EAAU,EAAK,EACXC,EAAS,SAAWA,EAAS,QAAQ,YAExBA,EAAS,QAAQ,UAAU,UAAU,EAC7C,QAAQuB,GAASA,EAAM,KAAA,CAAM,EACpCvB,EAAS,QAAQ,UAAY,OAGpBc,EAAA,CAEf,EAEC,WAAS,gBAAkB,YAAA,CAC9B,EAEClB,GAAS0B,EAAA,IAAC,MAAI,CAAA,UAAU,eAAgB,SAAM1B,EAAA,SAE9C,MAAI,CAAA,UAAW,mBAAmBE,EAAS,YAAc,EAAE,GAC1D,SAAA,CAACuB,EAAAA,KAAA,MAAA,CAAI,UAAU,UACb,SAAA,CAAAC,EAAA,IAAC,MAAA,CACC,UAAU,kBACV,MAAO,CAAE,UAAW,UAAUH,EAAA,CAAwB,MAAO,EAE7D,SAACG,EAAA,IAAA,MAAA,CAAI,UAAU,gBAAgB,SAAE,IAAA,CAAA,CAAA,CACnC,EACAA,EAAAA,IAAC,MAAI,CAAA,UAAU,kBAAmB,CAAA,CAAA,EACpC,EAEAD,EAAAA,KAAC,MAAI,CAAA,UAAU,aACb,SAAA,CAAAA,OAAC,IAAE,CAAA,SAAA,CAAA,4BACDhC,GACA,IAAI,KAAKL,WAAqB,IAAA,KAAQK,EAAS,IAAKA,EAAS,GAAG,EAAE,MAAM,EACrE,mBAAmB,CAAA,EACvB,SACA,IAAE,CAAA,SAAA,CAAA,eAAaG,EAAW,QAAQ,CAAC,EAAE,GAAA,EAAC,EACvC8B,EAAAA,IAAC,MAAI,CAAA,UAAW,sBAAsBF,EAAY,UAAY,EAAE,GAC7D,SAAYA,EAAA,gBAAkB,0BACjC,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,EACF,CAEJ,EChNAI,EAAA,WAAW,SAAS,eAAe,MAAM,CAAC,EAAE,OACzCF,EAAA,IAAAG,EAAA,WAAA,CACC,SAACH,EAAAA,IAAAlC,EAAA,CAAA,CAAI,CACP,CAAA,CACF"}