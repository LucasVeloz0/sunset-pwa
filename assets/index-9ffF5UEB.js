import{r as o,j as t,c as A}from"./react-vendor-BzzwJzSH.js";import{s as x}from"./suncalc-DPRD1gft.js";import"./vendor-SPyfQU6S.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))u(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function d(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function u(s){if(s.ep)return;s.ep=!0;const i=d(s);fetch(s.href,i)}})();const P=(c,l)=>{const d=new Date,u=x.getTimes(d,c,l).sunset;return(x.getPosition(u,c,l).azimuth*180/Math.PI+180)%360},D=c=>(360-c)%360,L=()=>{const[c,l]=o.useState(null),[d,u]=o.useState(0),[s,i]=o.useState(0),[m,f]=o.useState(null),[h,g]=o.useState(!1),[v,j]=o.useState(null),[p,y]=o.useState("environment"),a=o.useRef(null),w=o.useRef(null);o.useEffect(()=>{const e=n=>{l({lat:n.coords.latitude,lng:n.coords.longitude})},r=n=>{f(n.message||"Erro ao obter localiza√ß√£o")};if(!navigator.geolocation){f("Geolocaliza√ß√£o n√£o suportada");return}navigator.geolocation.getCurrentPosition(e,r,{enableHighAccuracy:!0,timeout:5e3})},[]),o.useEffect(()=>{if(c){const e=P(c.lat,c.lng);u(e)}},[c]),o.useEffect(()=>{const e=r=>{if(r.alpha!==null){let n=r.alpha;typeof r.webkitCompassHeading<"u"&&(n=r.webkitCompassHeading),i(D(n))}};return window.DeviceOrientationEvent?window.addEventListener("deviceorientation",e,!0):f("Sensor de orienta√ß√£o n√£o suportado neste dispositivo"),()=>{window.removeEventListener("deviceorientation",e)}},[]),o.useEffect(()=>{let e=null;return h&&(async()=>{try{if(a.current&&a.current.srcObject)return;const n={video:{facingMode:p,width:{ideal:1280},height:{ideal:720}}};a.current&&a.current.srcObject&&(a.current.srcObject.getTracks().forEach(b=>b.stop()),a.current.srcObject=null),e=await navigator.mediaDevices.getUserMedia(n),a.current&&(a.current.srcObject=e,a.current.onloadedmetadata=()=>{a.current.play().catch(b=>{f("Erro ao reproduzir v√≠deo: "+b.message)})})}catch(n){f("Erro ao acessar c√¢mera: "+n.message),g(!1)}})(),()=>{e&&e.getTracks().forEach(n=>n.stop())}},[h,p]);const O=()=>{y(e=>e==="user"?"environment":"user")},C=()=>{const e=a.current,r=w.current;if(e&&r&&e.readyState>=2){r.width=e.videoWidth,r.height=e.videoHeight;const n=r.getContext("2d");p==="user"&&(n.translate(r.width,0),n.scale(-1,1)),n.drawImage(e,0,0,r.width,r.height),j(r.toDataURL("image/jpeg",.9))}},S=()=>{var e;(e=a.current)!=null&&e.srcObject&&(a.current.srcObject.getTracks().forEach(r=>r.stop()),a.current.srcObject=null),g(!1),j(null)};o.useEffect(()=>()=>{var e;(e=a.current)!=null&&e.srcObject&&a.current.srcObject.getTracks().forEach(r=>r.stop())},[]);const E=()=>{let e=(d-s+360)%360;return e>180&&(e-=360),e},N=Math.abs(E())<15;return t.jsxs("div",{className:"app-container",children:[t.jsx("h1",{children:"üåÖ Localizando o P√¥r do Sol"}),h&&t.jsxs("div",{className:"camera-container",children:[t.jsx("video",{ref:a,className:`camera-preview${p==="user"?" mirrored":""}`,playsInline:!0,muted:!0}),t.jsxs("div",{className:"camera-controls",children:[t.jsx("button",{className:"camera-btn",onClick:O,"aria-label":"Alternar c√¢mera",children:"üîÑ"}),t.jsx("button",{className:"camera-btn capture-btn",onClick:C,"aria-label":"Capturar foto",children:"‚≠ï"}),t.jsx("button",{className:"camera-btn",onClick:S,"aria-label":"Fechar c√¢mera",children:"‚úñ"})]}),v&&t.jsxs("div",{className:"photo-preview",children:[t.jsx("img",{src:v,alt:"Foto capturada"}),t.jsx("a",{href:v,download:`por-do-sol-${Date.now()}.jpg`,className:"download-button",children:"‚¨áÔ∏è Baixar"}),t.jsx("button",{onClick:()=>j(null),className:"close-button",children:"‚ùå Fechar"})]})]}),!h&&t.jsx("button",{className:"main-camera-btn",onClick:()=>g(!0),children:"üì∏ Ativar C√¢mera"}),t.jsxs("div",{className:"compass-wrapper",children:[t.jsxs("div",{className:"compass",children:[t.jsx("div",{className:"direction-arrow",style:{transform:`rotate(${E()}deg)`},children:t.jsx("div",{className:"sun-indicator",children:"‚òÄÔ∏è"})}),t.jsx("div",{className:"alignment-marker"})]}),t.jsxs("div",{className:"info-panel",children:[t.jsxs("p",{children:["‚è± Hor√°rio do p√¥r do sol: ",c&&new Date(x.getTimes(new Date,c.lat,c.lng).sunset).toLocaleTimeString()]}),t.jsxs("p",{children:["üß≠ Dire√ß√£o: ",d.toFixed(1),"¬∞"]}),t.jsx("div",{className:`alignment-feedback ${N?"aligned":""}`,children:N?"‚≠ê ALINHADO! ‚≠ê":"Gire o dispositivo... ‚û°Ô∏è"})]})]}),m&&t.jsx("div",{className:"error-banner",children:m}),t.jsx("canvas",{ref:w,style:{display:"none"}})]})};A.createRoot(document.getElementById("root")).render(t.jsx(o.StrictMode,{children:t.jsx(L,{})}));
//# sourceMappingURL=index-9ffF5UEB.js.map
