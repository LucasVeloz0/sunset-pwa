import{r as a,j as n,c as O}from"./react-vendor-BzzwJzSH.js";import{s as y}from"./suncalc-DPRD1gft.js";import"./vendor-SPyfQU6S.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))f(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&f(m)}).observe(document,{childList:!0,subtree:!0});function d(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function f(t){if(t.ep)return;t.ep=!0;const i=d(t);fetch(t.href,i)}})();const A=(c,l)=>{const d=new Date,f=y.getTimes(d,c,l).sunset;return(y.getPosition(f,c,l).azimuth*180/Math.PI+180)%360},N=c=>(360-c)%360,S=()=>{const[c,l]=a.useState(null),[d,f]=a.useState(0),[t,i]=a.useState(0),[m,h]=a.useState(null),[u,g]=a.useState(!1),r=a.useRef(null),[b,x]=a.useState(!1);a.useEffect(()=>{const e=o=>{l({lat:o.coords.latitude,lng:o.coords.longitude})},s=o=>{h(o.message||"Erro ao obter localiza√ß√£o")};if(!navigator.geolocation){h("Geolocaliza√ß√£o n√£o suportada");return}navigator.geolocation.getCurrentPosition(e,s,{enableHighAccuracy:!0,timeout:5e3})},[]),a.useEffect(()=>{if(c){const e=A(c.lat,c.lng);f(e)}},[c]),a.useEffect(()=>{const e=s=>{if(s.alpha!==null){let o=s.alpha;typeof s.webkitCompassHeading<"u"&&(o=s.webkitCompassHeading),i(N(o))}};return window.addEventListener("deviceorientation",e,!0),()=>{window.removeEventListener("deviceorientation",e)}},[]),a.useEffect(()=>{if(u&&r.current){const e=r.current,s=()=>{e.play().catch(o=>console.log("Auto-play error:",o))};return e.oncanplay=s,()=>{e.oncanplay=null}}},[u]),a.useEffect(()=>{if(u){const e=()=>{r.current&&r.current.play().catch(s=>console.log("Touch play error:",s))};return document.addEventListener("touchstart",e),()=>{document.removeEventListener("touchstart",e)}}},[u]),a.useEffect(()=>()=>{var e;(e=r.current)!=null&&e.srcObject&&(r.current.srcObject.getTracks().forEach(o=>o.stop()),r.current.srcObject=null)},[]);const w=async()=>{var e;try{(e=r.current)!=null&&e.srcObject&&r.current.srcObject.getTracks().forEach(p=>p.stop());const s={video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}},o=await navigator.mediaDevices.getUserMedia(s);if(r.current){r.current.srcObject=o,r.current.playsInline=!0,r.current.muted=!0;const v=(p=0)=>{r.current.play().then(()=>g(!0)).catch(P=>{p<3?setTimeout(()=>v(p+1),300*(p+1)):(h("Falha ao iniciar c√¢mera. Toque na tela para tentar novamente."),g(!1))})};v()}}catch(s){console.error("AR Error:",s),h(`Erro: ${s.message}`),g(!1)}},j=()=>(d-t+360)%360,E=Math.abs(j())<5;return n.jsxs("div",{className:"app-container",children:[u&&n.jsx("video",{ref:r,className:"ar-video",autoPlay:!0,playsInline:!0,muted:!0,"webkit-playsinline":"true","x-webkit-airplay":"allow"}),n.jsx("h1",{children:"üåÖ Ca√ßador de P√¥r do Sol"}),n.jsx("button",{className:`ar-button ${b?"active":""}`,onClick:async()=>{var e;u?((e=r.current)!=null&&e.srcObject&&(r.current.srcObject.getTracks().forEach(o=>o.stop()),r.current.srcObject=null),g(!1),x(!1)):await w()},children:u?"üì∑ Desativar AR":"üåç Modo AR"}),m&&n.jsx("div",{className:"error-banner",children:m}),n.jsxs("div",{className:`compass-wrapper ${u?"ar-active":""}`,children:[n.jsxs("div",{className:"compass",children:[n.jsx("div",{className:"direction-arrow",style:{transform:`rotate(${j()}deg)`},children:n.jsx("div",{className:"sun-indicator",children:"‚òÄÔ∏è"})}),n.jsx("div",{className:"alignment-marker"})]}),n.jsxs("div",{className:"info-panel",children:[n.jsxs("p",{children:["‚è± Hor√°rio do p√¥r do sol: ",c&&new Date(y.getTimes(new Date,c.lat,c.lng).sunset).toLocaleTimeString()]}),n.jsxs("p",{children:["üß≠ Dire√ß√£o: ",d.toFixed(1),"¬∞"]}),n.jsx("div",{className:`alignment-feedback ${E?"aligned":""}`,children:E?"‚≠ê ALINHADO! ‚≠ê":"Gire o dispositivo... ‚û°Ô∏è"})]})]})]})};O.createRoot(document.getElementById("root")).render(n.jsx(a.StrictMode,{children:n.jsx(S,{})}));
//# sourceMappingURL=index-omWZRX86.js.map
