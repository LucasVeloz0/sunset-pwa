import{r as n,j as e,c as C}from"./react-vendor-BzzwJzSH.js";import{s as g}from"./suncalc-DPRD1gft.js";import"./vendor-SPyfQU6S.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))u(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const m of a.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function d(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function u(s){if(s.ep)return;s.ep=!0;const a=d(s);fetch(s.href,a)}})();const P=(o,c)=>{const d=new Date,u=g.getTimes(d,o,c).sunset;return(g.getPosition(u,o,c).azimuth*180/Math.PI+180)%360},S=o=>(360-o)%360,A=()=>{const[o,c]=n.useState(null),[d,u]=n.useState(0),[s,a]=n.useState(0),[m,h]=n.useState(null),[v,f]=n.useState(!1),[p,x]=n.useState(null),l=n.useRef(null),j=n.useRef(null);n.useEffect(()=>{const r=i=>{c({lat:i.coords.latitude,lng:i.coords.longitude})},t=i=>{h(i.message||"Erro ao obter localizaÃ§Ã£o")};if(!navigator.geolocation){h("GeolocalizaÃ§Ã£o nÃ£o suportada");return}navigator.geolocation.getCurrentPosition(r,t,{enableHighAccuracy:!0,timeout:5e3})},[]),n.useEffect(()=>{if(o){const r=P(o.lat,o.lng);u(r)}},[o]),n.useEffect(()=>{const r=t=>{if(t.alpha!==null){let i=t.alpha;typeof t.webkitCompassHeading<"u"&&(i=t.webkitCompassHeading),a(S(i))}};return window.addEventListener("deviceorientation",r,!0),()=>{window.removeEventListener("deviceorientation",r)}},[]);const y=async()=>{try{const r={video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}},t=await navigator.mediaDevices.getUserMedia(r);l.current&&(l.current.srcObject=t,l.current.onloadedmetadata=()=>{l.current.play().catch(()=>{h("Toque na tela para iniciar a cÃ¢mera")})},f(!0))}catch(r){h(r.message),f(!1)}},w=()=>{const r=l.current,t=j.current;if(r&&t){t.width=r.videoWidth,t.height=r.videoHeight;const i=t.getContext("2d");i.translate(t.width,0),i.scale(-1,1),i.drawImage(r,0,0,t.width,t.height),x(t.toDataURL("image/jpeg",.9))}},E=()=>{var r;(r=l.current)!=null&&r.srcObject&&l.current.srcObject.getTracks().forEach(t=>t.stop()),f(!1),x(null)},N=()=>(d-s+360)%360,b=Math.abs(N())<5;return e.jsxs("div",{className:"app-container",children:[e.jsx("h1",{children:"ðŸŒ… Guia FotogrÃ¡fico do PÃ´r do Sol"}),!v&&e.jsx("button",{className:"camera-button",onClick:y,children:"ðŸ“¸ Ativar CÃ¢mera"}),v&&e.jsxs("div",{className:"camera-interface",children:[e.jsx("video",{ref:l,className:"camera-preview",playsInline:!0,muted:!0,onClick:w}),e.jsx("canvas",{ref:j,className:"photo-canvas"}),e.jsxs("div",{className:"camera-controls",children:[e.jsx("button",{className:"capture-button",onClick:w,children:"â­• Capturar"}),e.jsx("button",{className:"close-button",onClick:E,children:"âœ– Fechar"})]}),p&&e.jsxs("div",{className:"photo-preview",children:[e.jsx("img",{src:p,alt:"Foto capturada"}),e.jsx("a",{href:p,download:`por-do-sol-${Date.now()}.jpg`,className:"download-button",children:"â¬‡ï¸ Baixar"})]})]}),e.jsxs("div",{className:"compass-wrapper",children:[e.jsxs("div",{className:"compass",children:[e.jsx("div",{className:"direction-arrow",style:{transform:`rotate(${N()}deg)`},children:e.jsx("div",{className:"sun-indicator",children:"â˜€ï¸"})}),e.jsx("div",{className:"alignment-marker"})]}),e.jsxs("div",{className:"info-panel",children:[e.jsxs("p",{children:["â± HorÃ¡rio do pÃ´r do sol: ",o&&new Date(g.getTimes(new Date,o.lat,o.lng).sunset).toLocaleTimeString()]}),e.jsxs("p",{children:["ðŸ§­ DireÃ§Ã£o: ",d.toFixed(1),"Â°"]}),e.jsx("div",{className:`alignment-feedback ${b?"aligned":""}`,children:b?"â­ ALINHADO! â­":"Gire o dispositivo... âž¡ï¸"})]})]}),m&&e.jsx("div",{className:"error-banner",children:m})]})};C.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(A,{})}));
//# sourceMappingURL=index-CmyVzPN5.js.map
