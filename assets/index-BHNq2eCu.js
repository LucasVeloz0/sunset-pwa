import{r as n,j as t,c as P}from"./react-vendor-BzzwJzSH.js";import{s as j}from"./suncalc-DPRD1gft.js";import"./vendor-SPyfQU6S.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))u(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function d(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function u(s){if(s.ep)return;s.ep=!0;const i=d(s);fetch(s.href,i)}})();const A=(a,l)=>{const d=new Date,u=j.getTimes(d,a,l).sunset;return(j.getPosition(u,a,l).azimuth*180/Math.PI+180)%360},D=a=>(360-a)%360,L=()=>{const[a,l]=n.useState(null),[d,u]=n.useState(0),[s,i]=n.useState(0),[m,f]=n.useState(null),[h,p]=n.useState(!1),[g,x]=n.useState(null),[v,N]=n.useState("environment"),c=n.useRef(null),b=n.useRef(null);n.useEffect(()=>{const e=o=>{l({lat:o.coords.latitude,lng:o.coords.longitude})},r=o=>{f(o.message||"Erro ao obter localiza√ß√£o")};if(!navigator.geolocation){f("Geolocaliza√ß√£o n√£o suportada");return}navigator.geolocation.getCurrentPosition(e,r,{enableHighAccuracy:!0,timeout:5e3})},[]),n.useEffect(()=>{if(a){const e=A(a.lat,a.lng);u(e)}},[a]),n.useEffect(()=>{const e=r=>{if(r.alpha!==null){let o=r.alpha;typeof r.webkitCompassHeading<"u"&&(o=r.webkitCompassHeading),i(D(o))}};return window.DeviceOrientationEvent?window.addEventListener("deviceorientation",e,!0):f("Sensor de orienta√ß√£o n√£o suportado neste dispositivo"),()=>{window.removeEventListener("deviceorientation",e)}},[]),n.useEffect(()=>{let e=null;return h&&(async()=>{try{if(c.current&&c.current.srcObject)return;const o={video:{facingMode:v,width:{ideal:1280},height:{ideal:720}}};e=await navigator.mediaDevices.getUserMedia(o),c.current&&(c.current.srcObject=e,c.current.onloadedmetadata=()=>{c.current.play().catch(C=>{f("Erro ao reproduzir v√≠deo: "+C.message)})})}catch(o){f("Erro ao acessar c√¢mera: "+o.message),p(!1)}})(),()=>{e&&e.getTracks().forEach(o=>o.stop())}},[h,v]);const y=()=>{N(e=>e==="user"?"environment":"user")},O=()=>{const e=c.current,r=b.current;if(e&&r&&e.readyState>=2){r.width=e.videoWidth,r.height=e.videoHeight;const o=r.getContext("2d");v==="user"&&(o.translate(r.width,0),o.scale(-1,1)),o.drawImage(e,0,0,r.width,r.height),x(r.toDataURL("image/jpeg",.9))}},S=()=>{var e;(e=c.current)!=null&&e.srcObject&&(c.current.srcObject.getTracks().forEach(r=>r.stop()),c.current.srcObject=null),p(!1),x(null)};n.useEffect(()=>()=>{var e;(e=c.current)!=null&&e.srcObject&&c.current.srcObject.getTracks().forEach(r=>r.stop())},[]);const w=()=>(d-s+360)%360,E=Math.abs(w())<5;return t.jsxs("div",{className:"app-container",children:[t.jsx("h1",{children:"üåÖ Guia Fotogr√°fico do P√¥r do Sol"}),h&&t.jsxs("div",{className:"camera-container",children:[t.jsx("video",{ref:c,className:"camera-preview",playsInline:!0,muted:!0}),t.jsxs("div",{className:"camera-controls",children:[t.jsx("button",{className:"camera-btn flip-btn",onClick:y,children:"üîÑ"}),t.jsx("button",{className:"camera-btn capture-btn",onClick:O,children:"‚≠ï"}),t.jsx("button",{className:"camera-btn close-btn",onClick:S,children:"‚úñ"})]}),g&&t.jsxs("div",{className:"photo-preview",children:[t.jsx("img",{src:g,alt:"Foto capturada"}),t.jsx("a",{href:g,download:`por-do-sol-${Date.now()}.jpg`,className:"download-button",children:"‚¨áÔ∏è Baixar"})]})]}),!h&&t.jsx("button",{className:"main-camera-btn",onClick:()=>p(!0),children:"üì∏ Ativar C√¢mera"}),t.jsxs("div",{className:"compass-wrapper",children:[t.jsxs("div",{className:"compass",children:[t.jsx("div",{className:"direction-arrow",style:{transform:`rotate(${w()}deg)`},children:t.jsx("div",{className:"sun-indicator",children:"‚òÄÔ∏è"})}),t.jsx("div",{className:"alignment-marker"})]}),t.jsxs("div",{className:"info-panel",children:[t.jsxs("p",{children:["‚è± Hor√°rio do p√¥r do sol: ",a&&new Date(j.getTimes(new Date,a.lat,a.lng).sunset).toLocaleTimeString()]}),t.jsxs("p",{children:["üß≠ Dire√ß√£o: ",d.toFixed(1),"¬∞"]}),t.jsx("div",{className:`alignment-feedback ${E?"aligned":""}`,children:E?"‚≠ê ALINHADO! ‚≠ê":"Gire o dispositivo... ‚û°Ô∏è"})]})]}),m&&t.jsx("div",{className:"error-banner",children:m}),t.jsx("canvas",{ref:b,style:{display:"none"}})]})};P.createRoot(document.getElementById("root")).render(t.jsx(n.StrictMode,{children:t.jsx(L,{})}));
//# sourceMappingURL=index-BHNq2eCu.js.map
