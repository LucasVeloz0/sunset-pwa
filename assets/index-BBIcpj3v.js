import{r as c,j as o,c as b}from"./react-vendor-BzzwJzSH.js";import{s as g}from"./suncalc-DPRD1gft.js";import"./vendor-SPyfQU6S.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))m(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const f of i.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&m(f)}).observe(document,{childList:!0,subtree:!0});function d(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?i.credentials="include":t.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function m(t){if(t.ep)return;t.ep=!0;const i=d(t);fetch(t.href,i)}})();const A=(n,l)=>{const d=new Date,m=g.getTimes(d,n,l).sunset;return(g.getPosition(m,n,l).azimuth*180/Math.PI+180)%360},w=n=>(360-n)%360,N=()=>{const[n,l]=c.useState(null),[d,m]=c.useState(0),[t,i]=c.useState(0),[f,p]=c.useState(null),[u,h]=c.useState(!1),r=c.useRef(null);c.useEffect(()=>{const e=a=>{l({lat:a.coords.latitude,lng:a.coords.longitude})},s=a=>{p(a.message||"Erro ao obter localiza√ß√£o")};if(!navigator.geolocation){p("Geolocaliza√ß√£o n√£o suportada");return}navigator.geolocation.getCurrentPosition(e,s,{enableHighAccuracy:!0,timeout:5e3})},[]),c.useEffect(()=>{if(n){const e=A(n.lat,n.lng);m(e)}},[n]),c.useEffect(()=>{const e=s=>{if(s.alpha!==null){let a=s.alpha;typeof s.webkitCompassHeading<"u"&&(a=s.webkitCompassHeading),i(w(a))}};return window.addEventListener("deviceorientation",e,!0),()=>{window.removeEventListener("deviceorientation",e)}},[]),c.useEffect(()=>{if(u&&r.current){const e=r.current,s=()=>{e.play().catch(a=>console.log("Auto-play error:",a))};return e.oncanplay=s,()=>{e.oncanplay=null}}},[u]),c.useEffect(()=>{if(u){const e=()=>{r.current&&r.current.play().catch(s=>console.log("Touch play error:",s))};return document.addEventListener("touchstart",e),()=>{document.removeEventListener("touchstart",e)}}},[u]);const j=async()=>{try{const e={video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}}},s=await navigator.mediaDevices.getUserMedia(e);if(r.current){r.current.srcObject=s,r.current.playsInline=!0,r.current.muted=!0,r.current.setAttribute("playsinline","true"),r.current.setAttribute("muted","true");const a=r.current.play();a!==void 0&&a.catch(x=>{console.error("Erro ao reproduzir:",x),setTimeout(()=>{var E;(E=r.current)==null||E.play()},300)}),h(!0)}}catch(e){console.error("Erro AR:",e),p(`Erro: ${e.message}`),h(!1)}},v=()=>(d-t+360)%360,y=Math.abs(v())<5;return o.jsxs("div",{className:"app-container",children:[u&&o.jsx("video",{ref:r,className:"ar-video",autoPlay:!0,playsInline:!0}),o.jsx("h1",{children:"üåÖ Ca√ßador de P√¥r do Sol"}),o.jsx("button",{className:"ar-button",onClick:()=>{u?(h(!1),r.current&&r.current.srcObject&&(r.current.srcObject.getTracks().forEach(s=>s.stop()),r.current.srcObject=null)):j()},children:u?"üì∑ Sair do AR":"üåç Modo AR"}),f&&o.jsx("div",{className:"error-banner",children:f}),o.jsxs("div",{className:`compass-wrapper ${u?"ar-active":""}`,children:[o.jsxs("div",{className:"compass",children:[o.jsx("div",{className:"direction-arrow",style:{transform:`rotate(${v()}deg)`},children:o.jsx("div",{className:"sun-indicator",children:"‚òÄÔ∏è"})}),o.jsx("div",{className:"alignment-marker"})]}),o.jsxs("div",{className:"info-panel",children:[o.jsxs("p",{children:["‚è± Hor√°rio do p√¥r do sol: ",n&&new Date(g.getTimes(new Date,n.lat,n.lng).sunset).toLocaleTimeString()]}),o.jsxs("p",{children:["üß≠ Dire√ß√£o: ",d.toFixed(1),"¬∞"]}),o.jsx("div",{className:`alignment-feedback ${y?"aligned":""}`,children:y?"‚≠ê ALINHADO! ‚≠ê":"Gire o dispositivo... ‚û°Ô∏è"})]})]})]})};b.createRoot(document.getElementById("root")).render(o.jsx(c.StrictMode,{children:o.jsx(N,{})}));
//# sourceMappingURL=index-BBIcpj3v.js.map
