import{r as o,j as e,c as A}from"./react-vendor-BzzwJzSH.js";import{s as x}from"./suncalc-DPRD1gft.js";import"./vendor-SPyfQU6S.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))u(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function d(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function u(s){if(s.ep)return;s.ep=!0;const i=d(s);fetch(s.href,i)}})();const P=(a,l)=>{const d=new Date,u=x.getTimes(d,a,l).sunset;return(x.getPosition(u,a,l).azimuth*180/Math.PI+180)%360},D=a=>(360-a)%360,L=()=>{const[a,l]=o.useState(null),[d,u]=o.useState(0),[s,i]=o.useState(0),[m,f]=o.useState(null),[h,p]=o.useState(!1),[g,v]=o.useState(null),[j,E]=o.useState("environment"),c=o.useRef(null),b=o.useRef(null);o.useEffect(()=>{const t=n=>{l({lat:n.coords.latitude,lng:n.coords.longitude})},r=n=>{f(n.message||"Erro ao obter localiza√ß√£o")};if(!navigator.geolocation){f("Geolocaliza√ß√£o n√£o suportada");return}navigator.geolocation.getCurrentPosition(t,r,{enableHighAccuracy:!0,timeout:5e3})},[]),o.useEffect(()=>{if(a){const t=P(a.lat,a.lng);u(t)}},[a]),o.useEffect(()=>{const t=r=>{if(r.alpha!==null){let n=r.alpha;typeof r.webkitCompassHeading<"u"&&(n=r.webkitCompassHeading),i(D(n))}};return window.DeviceOrientationEvent?window.addEventListener("deviceorientation",t,!0):f("Sensor de orienta√ß√£o n√£o suportado neste dispositivo"),()=>{window.removeEventListener("deviceorientation",t)}},[]),o.useEffect(()=>{let t=null;return h&&(async()=>{try{if(c.current&&c.current.srcObject)return;const n={video:{facingMode:j,width:{ideal:1280},height:{ideal:720}}};t=await navigator.mediaDevices.getUserMedia(n),c.current&&(c.current.srcObject=t,c.current.onloadedmetadata=()=>{c.current.play().catch(C=>{f("Erro ao reproduzir v√≠deo: "+C.message)})})}catch(n){f("Erro ao acessar c√¢mera: "+n.message),p(!1)}})(),()=>{t&&t.getTracks().forEach(n=>n.stop())}},[h,j]);const y=()=>{E(t=>t==="user"?"environment":"user")},O=()=>{const t=c.current,r=b.current;if(t&&r&&t.readyState>=2){r.width=t.videoWidth,r.height=t.videoHeight;const n=r.getContext("2d");j==="user"&&(n.translate(r.width,0),n.scale(-1,1)),n.drawImage(t,0,0,r.width,r.height),v(r.toDataURL("image/jpeg",.9))}},S=()=>{var t;(t=c.current)!=null&&t.srcObject&&(c.current.srcObject.getTracks().forEach(r=>r.stop()),c.current.srcObject=null),p(!1),v(null)};o.useEffect(()=>()=>{var t;(t=c.current)!=null&&t.srcObject&&c.current.srcObject.getTracks().forEach(r=>r.stop())},[]);const w=()=>(d-s+360)%360,N=Math.abs(w())<5;return e.jsxs("div",{className:"app-container",children:[e.jsx("h1",{children:"üåÖ Amantes do P√¥r do Sol"}),h&&e.jsxs("div",{className:"camera-container",children:[e.jsx("video",{ref:c,className:"camera-preview",playsInline:!0,muted:!0}),e.jsxs("div",{className:"camera-controls",children:[e.jsx("button",{className:"camera-btn flip-btn",onClick:y,children:"üîÑ"}),e.jsx("button",{className:"camera-btn capture-btn",onClick:O,children:"‚≠ï"}),e.jsx("button",{className:"camera-btn close-btn",onClick:S,children:"‚úñ"})]}),g&&e.jsxs("div",{className:"photo-preview",children:[e.jsx("img",{src:g,alt:"Foto capturada"}),e.jsx("a",{href:g,download:`por-do-sol-${Date.now()}.jpg`,className:"download-button",children:"‚¨áÔ∏è Baixar"}),e.jsx("button",{onClick:()=>v(null),className:"close-button",children:"‚ùå Fechar"})]})]}),!h&&e.jsx("button",{className:"main-camera-btn",onClick:()=>p(!0),children:"üì∏ Ativar C√¢mera"}),e.jsxs("div",{className:"compass-wrapper",children:[e.jsxs("div",{className:"compass",children:[e.jsx("div",{className:"direction-arrow",style:{transform:`rotate(${w()}deg)`},children:e.jsx("div",{className:"sun-indicator",children:"‚òÄÔ∏è"})}),e.jsx("div",{className:"alignment-marker"})]}),e.jsxs("div",{className:"info-panel",children:[e.jsxs("p",{children:["‚è± Hor√°rio do p√¥r do sol: ",a&&new Date(x.getTimes(new Date,a.lat,a.lng).sunset).toLocaleTimeString()]}),e.jsxs("p",{children:["üß≠ Dire√ß√£o: ",d.toFixed(1),"¬∞"]}),e.jsx("div",{className:`alignment-feedback ${N?"aligned":""}`,children:N?"‚≠ê ALINHADO! ‚≠ê":"Gire o dispositivo... ‚û°Ô∏è"})]})]}),m&&e.jsx("div",{className:"error-banner",children:m}),e.jsx("canvas",{ref:b,style:{display:"none"}})]})};A.createRoot(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(L,{})}));
//# sourceMappingURL=index-BmKu5jGf.js.map
